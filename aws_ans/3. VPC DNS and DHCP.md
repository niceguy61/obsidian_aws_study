## 3. VPC DNS and DHCP
### Amazon VPC DNS 옵션

#### 요약:
- **Amazon VPC의 기본 DNS 기능:**
    
    - Amazon VPC는 기본적으로 DNS 해석 및 호스트 이름 생성 기능을 제공합니다.
    - 퍼블릭 및 프라이빗 DNS 옵션을 활성화하여 클라우드 환경에서 네트워크 자원을 효과적으로 관리.
- **DNS 호스트 이름 및 DNS 해석기:**
    
    - VPC 내에서 EC2 인스턴스에 자동으로 DNS 호스트 이름을 할당.
    - 기본적으로 `ec2.internal` 형식의 이름을 제공하며, 퍼블릭 IP가 활성화된 경우 퍼블릭 DNS 이름도 제공.
- **DNS 해석 옵션:**
    
    - 퍼블릭 DNS 해석을 허용하거나, 프라이빗 DNS만 허용하는 설정 가능.
    - AWS에서는 Route 53 Resolver를 통해 외부 DNS 쿼리를 처리할 수 있음.

#### 장점:

- 사용자가 별도로 관리할 필요 없이 자동으로 DNS가 할당.
- 프라이빗 DNS를 활용해 보안이 강화된 네트워크 환경 제공.

#### 단점:

- 기본 DNS 옵션은 커스텀 도메인 요구 사항에 적합하지 않을 수 있음.
- 퍼블릭 DNS를 활성화하면 잠재적인 보안 문제가 발생할 가능성.

#### AWS에서 관련 서비스:

- **Route 53 Resolver:** VPC와의 통합을 통해 DNS 쿼리를 처리.
- **DHCP 옵션 세트:** VPC 내 DNS 서버 주소를 동적으로 구성.

#### 주의사항:

- 퍼블릭 DNS 이름을 활성화하려면 VPC와 서브넷의 인터넷 게이트웨이가 올바르게 구성되어 있어야 함.
- 프라이빗 DNS를 사용할 때는 자체 DNS 서버를 설정하거나 AWS 제공 DNS를 사용해야 함.
### DNS VPC DNS Server (Route 53 Resolver)
![[vpc_dns_base.png]]
### Route 53 Resolver와의 통합

#### 요약:
- **Route 53 Resolver란?**
    - Amazon Route 53 Resolver는 VPC 내에서 DNS 쿼리를 처리하고 온프레미스 네트워크와의 통합을 지원하는 DNS 해석기입니다.
    - VPC와 온프레미스 네트워크 간 DNS 쿼리를 원활히 전송할 수 있도록 인바운드 및 아웃바운드 엔드포인트를 제공.
- **주요 기능:**
    - **인바운드 엔드포인트:**
        - 온프레미스 DNS 서버에서 AWS VPC로 DNS 쿼리를 전달.
    - **아웃바운드 엔드포인트:**
        - VPC 내 DNS 쿼리를 온프레미스 DNS 서버로 전달.
- **활용 사례:**
    - 온프레미스 네트워크와 AWS 간의 하이브리드 네트워크에서 통합된 DNS 관리.
    - 여러 VPC와 연결된 복잡한 네트워크 아키텍처에서 DNS 쿼리를 중앙 관리.
#### 장점:
- 하이브리드 네트워크에서 DNS 쿼리를 쉽게 통합 가능.
- VPC와 온프레미스 네트워크 간 상호작용을 단순화.
- 기존 DNS 서버를 유지하면서 AWS 네트워크를 통합할 수 있음.
#### 단점:
- 엔드포인트 설정 및 운영에 대한 추가 비용 발생.
- 잘못된 설정으로 인해 DNS 쿼리 흐름에 문제가 발생할 수 있음.
#### AWS에서 관련 서비스:
- **Route 53 Resolver:** 기본 제공 DNS 해석 및 인바운드/아웃바운드 엔드포인트.
- **VPC Peering:** 연결된 VPC 간 DNS 쿼리 처리.
- **Transit Gateway:** 여러 VPC와 온프레미스 네트워크 간 트래픽 관리.
#### 주의사항:
- 인바운드와 아웃바운드 엔드포인트는 보안 그룹을 통해 접근을 제어해야 함.
- VPC와 온프레미스 간 IP 주소 충돌이 없는지 확인 필수.
- 온프레미스 네트워크와 VPC 간 경로 설정이 정확해야 함.
#### 시험에서 자주 등장하는 패턴:
1. 하이브리드 네트워크에서 DNS 엔드포인트 구성 문제.
2. DNS 쿼리를 인바운드 및 아웃바운드 엔드포인트로 라우팅하는 시나리오.
3. Route 53 Resolver의 동작 원리를 묻는 문제.

### ### DHCP 옵션 세트

#### 요약:
- **DHCP 옵션 세트란?**
    - DHCP 옵션 세트를 통해 Amazon VPC에서 동적으로 IP 주소 및 네트워크 설정을 제공합니다.
    - 기본적으로 각 VPC는 하나의 DHCP 옵션 세트와 연결되며, 여러 네트워크 매개변수(예: DNS 서버, 도메인 이름 등)를 정의할 수 있음.
- **구성 가능한 옵션:**
    1. **Domain Name Servers (DNS):**
        - 네트워크의 기본 및 보조 DNS 서버를 지정.
    2. **Domain Name:**
        - 네트워크의 기본 도메인 이름을 설정.
    3. **NTP Servers:**
        - 네트워크 시간 동기화를 위한 NTP 서버 주소를 정의.
    4. **NetBIOS 옵션:**
        - Windows 기반 네트워크를 위한 NetBIOS 서버 및 관련 옵션을 설정.
- **활용 사례:**
    - VPC에서 커스텀 DNS 서버 사용.
    - 특정 NTP 서버로 시간 동기화.
    - 다양한 환경에 맞게 네트워크 매개변수를 동적으로 설정.

#### 장점:
- VPC 내 인스턴스가 네트워크 설정을 자동으로 수신.
- 다양한 네트워크 환경에서 쉽게 설정 변경 가능.
- 네트워크 관리 자동화로 설정 오류 최소화.

#### 단점:
- 모든 매개변수가 모든 네트워크 환경에 적용되지는 않음.
- 잘못된 옵션 설정 시 네트워크 접속 문제 발생 가능.

#### AWS에서 관련 서비스:
- **Amazon Route 53:** 커스텀 DNS 서버 설정 시 활용.
- **VPC Subnet:** 서브넷별로 DHCP 옵션 세트를 관리.

#### 주의사항:
- 기본 DHCP 옵션 세트는 삭제할 수 없으며, 필요한 경우 새 옵션 세트를 생성하여 대체.
- DHCP 옵션 세트는 VPC 단위로만 적용 가능(서브넷 단위는 불가).
- 커스텀 DNS 서버를 지정할 경우, 해당 서버가 가용한 상태인지 확인 필요.

#### 시험에서 자주 등장하는 패턴:
4. DHCP 옵션 세트를 사용하여 VPC 내 네트워크 설정 변경 문제.
5. 커스텀 DNS 서버를 사용한 구성 시나리오.
6. DHCP 옵션 세트와 기본 VPC 네트워크 매개변수의 관계를 묻는 질문.
